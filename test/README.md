# –¢–µ—Å—Ç—ã –¥–ª—è DQN –∞–≥–µ–Ω—Ç–∞

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ DQN –∞–≥–µ–Ω—Ç–∞ –∏ –µ–≥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

- **`__init__.py`** - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–ø–∫–∏
- **`test_configuration.py`** - –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ DQN
- **`test_neural_network.py`** - –¢–µ—Å—Ç—ã –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏
- **`test_dqn_solver.py`** - –¢–µ—Å—Ç—ã DQN solver
- **`test_nan_handling.py`** - –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ NaN –∑–Ω–∞—á–µ–Ω–∏–π
- **`test_gpu_replay.py`** - –¢–µ—Å—Ç—ã GPU replay buffer
- **`test_precomputed_states.py`** - –¢–µ—Å—Ç—ã –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
- **`test_torch_compile.py`** - –¢–µ—Å—Ç—ã torch.compile
- **`run_all_tests.py`** - –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```bash
cd test
python run_all_tests.py
```

### –ó–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
```bash
# –¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
python test_configuration.py

# –¢–µ—Å—Ç –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏
python test_neural_network.py

# –¢–µ—Å—Ç DQN solver
python test_dqn_solver.py

# –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ NaN
python test_nan_handling.py

# –¢–µ—Å—Ç GPU replay buffer
python test_gpu_replay.py

# –¢–µ—Å—Ç –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
python test_precomputed_states.py

# –¢–µ—Å—Ç torch.compile
python test_torch_compile.py
```

## üß™ –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`test_configuration.py`)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤

### 2. –ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å (`test_neural_network.py`)
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ DQN
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç forward pass
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (Dueling DQN, Layer Norm, Dropout)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ NaN –∑–Ω–∞—á–µ–Ω–∏–π

### 3. DQN Solver (`test_dqn_solver.py`)
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ DQN solver
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Prioritized Experience Replay
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –≤ replay buffer
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ NaN (`test_nan_handling.py`)
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É NaN –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –≤—Ö–æ–¥–µ
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–º–µ–Ω—É NaN –Ω–∞ –Ω—É–ª–∏
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å "–≥—Ä—è–∑–Ω—ã–º–∏" –¥–∞–Ω–Ω—ã–º–∏

### 5. GPU Replay Buffer (`test_gpu_replay.py`)
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å GPU-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ replay buffer
- –ò–∑–º–µ—Ä—è–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è, —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU –ø–∞–º—è—Ç–∏
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å CPU –≤–µ—Ä—Å–∏–µ–π

### 6. –ü—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π (`test_precomputed_states.py`)
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –ò–∑–º–µ—Ä—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ NaN –≤ –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 7. torch.compile (`test_torch_compile.py`)
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å PyTorch 2.x compile
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–∏ PyTorch
- –ò–∑–º–µ—Ä—è–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

## üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
- üöÄ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –ù–µ—É–¥–∞—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
- ‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã
- üîß –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

## üõ†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- PyTorch 2.0+ (–¥–ª—è torch.compile)
- CUDA (–¥–ª—è GPU —Ç–µ—Å—Ç–æ–≤)
- NumPy, Pandas
- –î–æ—Å—Ç—É–ø –∫ –º–æ–¥—É–ª—è–º –ø—Ä–æ–µ–∫—Ç–∞ (`agents.vdqn.*`, `envs.dqn_model.*`)

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞
export PYTHONPATH="${PYTHONPATH}:/app"
```

### –û—à–∏–±–∫–∏ CUDA
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å GPU
nvidia-smi

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é PyTorch
python -c "import torch; print(torch.cuda.is_available())"
```

### –û—à–∏–±–∫–∏ –ø–∞–º—è—Ç–∏
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ GPU –ø–∞–º—è—Ç—å
python -c "import torch; torch.cuda.empty_cache()"
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã:
- **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ replay buffer**: >500 —ç–ª–µ–º–µ–Ω—Ç–æ–≤/—Å
- **–°—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**: >20 –±–∞—Ç—á–µ–π/—Å
- **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π**: <1–º—Å –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **torch.compile —É—Å–∫–æ—Ä–µ–Ω–∏–µ**: 1.2x-1.5x

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç—ã —Ä–µ–≥—É–ª—è—Ä–Ω–æ** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ —Å –±–∞–∑–æ–≤—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ GPU –ø–∞–º—è—Ç—å** –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏
4. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ PyTorch** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π
