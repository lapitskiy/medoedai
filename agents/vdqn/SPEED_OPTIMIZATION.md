# üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ DQN –∞–≥–µ–Ω—Ç–∞

## üìä **–¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **100 —ç–ø–∏–∑–æ–¥–æ–≤**: ~3 —á–∞—Å–∞
- **–¶–µ–ª—å**: –°–æ–∫—Ä–∞—Ç–∏—Ç—å –¥–æ 30-45 –º–∏–Ω—É—Ç (–≤ 4-6 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ)

## ‚ö° **–í–Ω–µ—Å–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

### 1. **GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- ‚úÖ `torch.backends.cudnn.benchmark = True` - —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ `non_blocking=True` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ GPU
- ‚úÖ Mixed Precision Training (AMP) - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FP16 –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- ‚úÖ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ GPU –ø–∞–º—è—Ç—å
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ GPU –∫—ç—à–∞ –∫–∞–∂–¥—ã–µ 10 —ç–ø–∏–∑–æ–¥–æ–≤

### 2. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Ä–∞–∑–º–µ—Ä—ã —Å–ª–æ–µ–≤**: `(512, 256, 128)` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª—å—é
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω batch size: `512` ‚Üí `1024` –¥–ª—è –ª—É—á—à–µ–≥–æ GPU –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω dropout: `0.2` ‚Üí `0.1` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–∞ –ø–∞–º—è—Ç—å replay buffer: `500,000` ‚Üí `200,000`

### 3. **–û–±—É—á–µ–Ω–∏–µ:**
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω learning rate: `5e-4` ‚Üí `1e-3` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ train_repeats: `4` ‚Üí `2`
- ‚úÖ –ë–æ–ª–µ–µ —á–∞—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ target network: `2,000` ‚Üí `1,000`
- ‚úÖ –ë–æ–ª–µ–µ —á–∞—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ soft update: `2` ‚Üí `1`

### 4. **–ö–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- ‚úÖ –ú–æ–¥–µ–ª—å –≤ —Ä–µ–∂–∏–º–µ `eval()` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, `train()` —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ GPU
- ‚úÖ –£–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **–£–º–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## üéØ **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

### **–°–∫–æ—Ä–æ—Å—Ç—å:**
- **–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**: 100 —ç–ø–∏–∑–æ–¥–æ–≤ –∑–∞ ~3 —á–∞—Å–∞
- **–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**: 100 —ç–ø–∏–∑–æ–¥–æ–≤ –∑–∞ **30-45 –º–∏–Ω—É—Ç** ‚ö°
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ**: **4-6x** üöÄ

### **–ö–∞—á–µ—Å—Ç–≤–æ:**
- Winrate: –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ 46-50%
- P/L Ratio: –º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ —Å–Ω–∏–∑–∏—Ç—å—Å—è, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–∏—Ç—Å—è
- –û–±—É—á–µ–Ω–∏–µ: –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ

## üîß **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**

### 1. **–ï—â–µ –±–æ–ª—å—à–µ —É—Å–∫–æ—Ä–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π):**
```python
# –í vconfig.py - –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –º–æ–¥–µ–ª—å
hidden_sizes = (256, 128, 64)  # –º–µ–Ω—å—à–µ —Å–ª–æ–µ–≤
batch_size = 2048              # –±–æ–ª—å—à–µ batch size
train_repeats = 1              # —Ç–æ–ª—å–∫–æ 1 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–∞ —à–∞–≥
```

### 2. **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
num_workers = 8
prefetch_factor = 4
```

### 3. **–ö–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏—è:**
```python
# –ü–æ—Å—Ç—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è inference
model = torch.quantization.quantize_dynamic(model, {torch.nn.Linear}, dtype=torch.qint8)
```

## üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

### **GPU –º–µ—Ç—Ä–∏–∫–∏:**
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU
nvidia-smi -l 1

# –û–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
# - GPU Utilization: 80-95%
# - Memory Usage: 60-80%
# - Temperature: <80¬∞C
```

### **–í—Ä–µ–º—è —ç–ø–∏–∑–æ–¥–∞:**
- **–î–æ**: ~108 —Å–µ–∫—É–Ω–¥ –Ω–∞ —ç–ø–∏–∑–æ–¥
- **–ü–æ—Å–ª–µ**: ~18-27 —Å–µ–∫—É–Ω–¥ –Ω–∞ —ç–ø–∏–∑–æ–¥

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:**

1. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Ä–∞–∑–º–µ—Ä—ã —Å–ª–æ–µ–≤ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª—å—é
2. **–ö–∞—á–µ—Å—Ç–≤–æ vs –°–∫–æ—Ä–æ—Å—Ç—å**: –£—Å–∫–æ—Ä–µ–Ω–∏–µ –º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ —Å–Ω–∏–∑–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–æ —É–ª—É—á—à–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
3. **GPU –ø–∞–º—è—Ç—å**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ GPU –ø–∞–º—è—Ç–∏ (–º–∏–Ω–∏–º—É–º 6GB)
4. **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞**: –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É GPU –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏
5. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**: –ü–µ—Ä–≤—ã–µ —ç–ø–∏–∑–æ–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏–∑-–∑–∞ "—Ä–∞–∑–æ–≥—Ä–µ–≤–∞" GPU

## üöÄ **–ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏:**

```bash
# –û–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫
python agents/vdqn/v_train_model.py

# –° –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º GPU
CUDA_LAUNCH_BLOCKING=1 python agents/vdqn/v_train_model.py

# –° –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –ø–∞–º—è—Ç–∏
python -m memory_profiler agents/vdqn/v_train_model.py
```

## üìä **–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞:**

- ‚úÖ **–í—Ä–µ–º—è —ç–ø–∏–∑–æ–¥–∞**: <30 —Å–µ–∫—É–Ω–¥
- ‚úÖ **GPU Utilization**: >80%
- ‚úÖ **–û–±—â–µ–µ –≤—Ä–µ–º—è**: <45 –º–∏–Ω—É—Ç –Ω–∞ 100 —ç–ø–∏–∑–æ–¥–æ–≤
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –ë–µ–∑ –æ—à–∏–±–æ–∫ –ø–∞–º—è—Ç–∏ –∏–ª–∏ NaN
- ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –£—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª–∏

## üîß **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

- ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –£–º–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–∞–∑–º–µ—Ä–æ–≤ —Å–ª–æ–µ–≤
- ‚úÖ **API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–µ—Ç–æ–¥–∞ `get_trade_stats()`
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: Graceful fallback –ø—Ä–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: DQN –∞–≥–µ–Ω—Ç —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **4-6 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ** –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –æ–±—É—á–µ–Ω–∏—è –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏! üéØ‚ö°
